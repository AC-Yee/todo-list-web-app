<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8">
    <title>æˆ‘çš„ç¬¬ä¸€ä¸ªå¾…åŠé¡µé¢</title>
  </head>
  <body>
    <h1>ğŸ“‹ åˆ†ç±»å¾…åŠäº‹é¡¹</h1>
    
    <!-- æ·»åŠ ä»»åŠ¡çš„åŒºåŸŸ -->
    <div>
      <input type="text" id="taskInput" placeholder="è¾“å…¥æ–°çš„å¾…åŠäº‹é¡¹â€¦â€¦">

      <!-- æ–°å¢ï¼šåˆ†ç±»é€‰æ‹© -->
      <select id="categorySelect">
        <option value="å·¥ä½œ">å·¥ä½œ</option>
        <option value="å­¦ä¹ ">å­¦ä¹ </option>
        <option value="ç”Ÿæ´»">ç”Ÿæ´»</option>
        <option value="è´­ç‰©">è´­ç‰©</option>
        <option value="å…¶ä»–">å…¶ä»–</option>
      </select>

      <button id="addButton">æ·»åŠ ä»»åŠ¡</button>
    </div>

    <!-- æ˜¾ç¤ºä»»åŠ¡çš„åŒºåŸŸ -->
    <ul id="taskList">
      <!-- å°†æ¥ä»»åŠ¡ä¼šå‡ºç°åœ¨è¿™é‡Œ -->
    </ul>

    <!-- ç»Ÿè®¡æ˜¾ç¤º -->
    <div id="stats">æ€»æ•°ï¼š0 ï½œ å·²å®Œæˆï¼š0</div>

    <script>
      // â€”â€” åº”ç”¨çŠ¶æ€ï¼ˆå”¯ä¸€çœŸç›¸ï¼‰â€”â€”
      let tasks = []; // æ¯ä¸ªä»»åŠ¡ï¼š{ id: number, text: string, completed: boolean }
      const STORAGE_KEY = 'my_todos_v1';

      function save() {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks));
      }

      function updateStats() {
        const statsDiv = document.getElementById('stats');
        const total = tasks.length;
        const done = tasks.filter(t => t.completed).length;
        statsDiv.textContent = `æ€»æ•°ï¼š${total} ï½œ å·²å®Œæˆï¼š${done}`;
      }
      
      function render() {
        list.innerHTML = '';

        if (tasks.length === 0) {
          const li = document.createElement('li');
          li.textContent = 'æš‚æ— ä»»åŠ¡ï¼Œå…ˆæ·»åŠ ä¸€ä¸ªå§ã€‚';
          li.style.color = '#777';
          list.appendChild(li);
          return;
        }

        tasks.forEach(task => {
          const li = document.createElement('li');

          // å‹¾é€‰æ¡†
          const check = document.createElement('input');
          check.type = 'checkbox';
          check.checked = task.completed;

          // æ–‡æœ¬
          const span = document.createElement('span');
          span.textContent = task.text;
          if (task.completed) {
            span.style.textDecoration = 'line-through';
            span.style.color = '#777';
          }

          // åˆ é™¤æŒ‰é’®
          const del = document.createElement('button');
          del.textContent = 'åˆ é™¤';

          // å‹¾é€‰è¡Œä¸ºï¼šæ”¹â€œçŠ¶æ€â€é‡Œçš„ completedï¼Œå†ä¿å­˜+é‡æ¸²æŸ“+ç»Ÿè®¡
          check.addEventListener('change', () => {
            task.completed = check.checked;
            save();
            render();
            updateStats();
          });

          // åˆ é™¤è¡Œä¸ºï¼šä»â€œçŠ¶æ€â€é‡Œç§»é™¤ï¼Œå†ä¿å­˜+é‡æ¸²æŸ“+ç»Ÿè®¡
          del.addEventListener('click', () => {
            tasks = tasks.filter(t => t.id !== task.id);
            save();
            render();
            updateStats();
          });

          li.appendChild(check);
          li.appendChild(span);
          li.appendChild(del);
          list.appendChild(li);
        });
      }
    
      // è·å–é¡µé¢å…ƒç´ 
      const input = document.getElementById('taskInput'); // è¾“å…¥æ¡†
      const button = document.getElementById('addButton'); // æŒ‰é’®
      const list = document.getElementById('taskList'); // åˆ—è¡¨

      // ç»™æŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶
      button.addEventListener('click', function () {
        const text = input.value.trim();
        if (!text) { alert('è¯·è¾“å…¥å†…å®¹'); return; }

        // å¾€â€œçŠ¶æ€â€é‡ŒåŠ ä¸€æ¡
        tasks.push({
          id: Date.now(),
          text,
          completed: false
        });

        // ä¿å­˜ â†’ é‡æ–°æ¸²æŸ“ â†’ ç»Ÿè®¡
        save();
        render();
        updateStats();

        input.value = '';
        input.focus();
      });

      // æŒ‰ Enter ç›´æ¥æ·»åŠ ä»»åŠ¡
      input.addEventListener('keydown', function (e) {
          if (e.key === 'Enter') {
              button.click(); // è§¦å‘â€œæ·»åŠ ä»»åŠ¡â€å’Œåç»­æ¸²æŸ“/ç»Ÿè®¡
          }
      });

      document.addEventListener('DOMContentLoaded', () => {
        // 1) å…ˆä» localStorage è¯»å–
        const raw = localStorage.getItem(STORAGE_KEY);
        tasks = raw ? JSON.parse(raw) : [];

        // 2) æ¸²æŸ“ + ç»Ÿè®¡
        render();
        updateStats();
      });

    </script>
  </body>
</html>
